<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    var tok = localStorage.getItem('token');
    alert(tok)


    /// dashboard creation
    $.ajax({
      type: 'get',
      url: 'http://localhost:90/users/me',
      beforeSend: function (xhr) {
        if (tok) {
          xhr.setRequestHeader('Authorization', 'Bearer ' + tok);
        }
      },
      success: function (data) {
        $('#stage').append('<p> Name: ' + data.name + '</p>' + "<p>Email : " + data.age + "<p/>");
          
        //alert(user)
      },
      error: function () {
        alert("Sorry, you are not logged in.");
      }
    });

    // for logging out
    $("#adds").click(function (e) {
      e.preventDefault();
      pname = $('#pname').val();
      type = $('#type').val();
      price = $('#price').val();
      sold_to = $('#sold_to').val();
      data = {
        "pname": pname,
        "type": type,
        "price": price,
        "sold_to": sold_to
      }
      console.log(data);

      $.ajax({
        type: 'post',
        url: 'http://localhost:90/addproduct',
        dataType: 'json',
        data: data,
        beforeSend: function (xhr) {
          if (tok) {
            xhr.setRequestHeader('Authorization', 'Bearer ' + tok);
          }
        },
        success: function (data) {
          alert(data);
        },
        error: function (e) {
          console.log(e);
        }
      });

    })
    $("#logout").click(function () {
      $.ajax({
        type: 'post',
        url: 'http://localhost:90/users/logout',
        beforeSend: function (xhr) {
          if (tok) {
            xhr.setRequestHeader('Authorization', 'Bearer ' + tok);
          }
        },
        success: function (data) {
          $('#stage').append('<p> Name: ' + data.name + '</p>' + "<p>Email : " + data.age + "<p/>");

        },
        error: function () {
          alert("Sorry, you are not logged in.");
        }
      });
    })






  });



</script>
</head>

<body>


  <div id="stage">dd</div>
  <button id="logout">LOGOUT</button>

  <form>
    <label>Product NAME</label><input type="text" id="pname" /><br />
    <label>Type</label><input type="text" id="type" /><br />
    <label>price</label><input type="text" id="price" /><br />
    <label>sold to</label><input type="text" id="sold_to" /><br />

    <button id="adds">Add</button>

  </form>
</body>

</html>